# **P2P News App (Decentralized Blog App)**

A simple, decentralized blog system with **multi-device identity**, **subscriptions**, **pairing**, and **P2P sync**.

## **What This App Does**

* Create decentralized blog posts
* Sync across multiple devices (phone + laptop share same identity)
* Pair new devices through invite codes
* Discover other blogs via Hyperswarm
* Subscribe/unsubscribe to blogs
* Store profiles + avatars

---

# **Usage**

```js
const blog_app = require('p2p-news-app')
const api = blog_app(vault)  // vault comes from the identity module
```

---

# **API Overview**

## **1. init_blog(options)**

Start a new blog OR join an existing one (via pairing).

```js
// New blog
const { store, swarm } = await api.init_blog({ username: 'alice' })

// Pair a new device
await api.init_blog({ username: 'temp-device', invite_code: 'abc123...' })
```

Returns:
`{ store, swarm }` → Corestore + Hyperswarm instances

---

## **2. Blog Posts**

### `create_post({ title, content, username })`

```js
await api.create_post({
  title: 'Hello',
  content: 'Decentralized world!',
  username: 'alice'
})
```

### `get_my_posts()`

```js
const posts = await api.get_my_posts()
```

---

## **3. Profile**

### `get_profile()`

Get your blog's profile metadata.

### `get_avatar_content()`

Downloads your avatar as a Buffer.

### `upload_avatar(buffer, mime)`

Upload a new avatar.

---

## **4. Subscriptions & Discovery**

### `subscribe(peer_key)` / `unsubscribe(peer_key)`

Follow or unfollow another blog.

### `get_peer_blogs()`

Blogs you’re subscribed to.

### `get_discovered_blogs()`

Blogs found on the network (whether subscribed or not).

---

## **5. Device Management**

### `create_invite()`

Generate pairing code for a new device.

### `get_paired_devices()`

See all devices acting under your identity.

### `remove_device(writer_key)`

Kick a device out.

---

## **6. Getters**

```js
api.get_blog_username()
api.get_blog_profile_drive_key()
api.get_blog_events_drive_key()

api.get_drive()
api.get_profile_drive()
api.get_autobase()
api.get_autobase_key()

api.get_metadata_store()
api.get_drive_store()
// ...
```

Also:

* `api.get_structure_names()`
* `api.get_pairing_result()`
* `api.get_raw_data()`
* `api.get_local_key()`

---

## **7. Events**

```js
api.on_update(() => {
  console.log("New content detected!")
})
```

---

# **Data Structures**

Managed by `datastructure-manager`:

1. `metadata` (autobase) – posts + metadata
2. `drive` – file content (post bodies)
3. `profile` – avatar + profile.json
4. `events` – device events
5. `comments` – optional, extensible

---

# **Mini Example**

```js
const identity = require('identity')
const blog_app = require('p2p-news-app')

const vault = identity({ name: 'my-blog' })
const api = blog_app(vault)

await api.init_blog({ username: 'alice' })

await api.create_post({
  title: 'Hello World',
  content: 'My first P2P post!',
  username: 'alice'
})

const posts = await api.get_my_posts()
console.log(posts)

const invite = await api.create_invite()
console.log('Pair with:', invite)
```

---

# **Pairing Flow (Simplified)**

### **Main device**

```js
const api1 = blog_app(vault1)
await api1.init_blog({ username: 'alice' })
const code = await api1.create_invite()
```

### **Second device**

```js
const api2 = blog_app(vault2)
await api2.init_blog({ username: 'temp', invite_code: code })
```

Now both devices behave like one identity.

---

# **Architecture (Simple View)**

```
UI Layer → Blog App → Identity Module
```

* UI handles interface
* Blog App handles posts, profiles, subscriptions
* Identity module handles networking + pairing

---

# **Design Principles**

* Blog logic only (networking delegated to identity module)
* Multi-device by default
* Easy to extend with more structures (comments, likes, etc.)

